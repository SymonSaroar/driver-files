<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110109-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-110109-1');
</script>
<script type="text/javascript" src="../common/version.js"></script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="Chapter 16: Dynamically Loading Your Driver"/>
<title>Jungo WinDriver: Chapter 16: Dynamically Loading Your Driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-main.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="wd_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Jungo WinDriver
   &#160;
   <span id="projectnumber"></span>
   </div>
   <div id="projectbrief">Official Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ch16_dynamically_loading_your_driver.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Chapter 16: Dynamically Loading Your Driver </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_chap16"></a> </p>
<h1><a class="anchor" id="ch16_1_why_do_you_need_a_dynamically_loadable_driver"></a>
16.1. Why Do You Need a Dynamically Loadable Driver?</h1>
<p >When adding a new driver, you may be required to reboot the system in order for it to load your new driver into the system. WinDriver is a dynamically loadable driver, which enables your customers to start your application immediately after installing it, without the need for reboot.</p>
<p >You can dynamically load your driver whether you have created a user-mode or a kernel-mode (see Kernel PlugIn in <a class="el" href="ch12_understanding_the_kernel_plugin.html">Chapter 12: Understanding the Kernel PlugIn</a>) driver.</p>
<p >To successfully unload your driver, make sure that there are no open handles to the WinDriver service (<code>windrvr1511.sys</code> or your renamed driver), and that there are no connected and enabled Plug-and-Play devices that are registered with this service.</p>
<h1><a class="anchor" id="ch16_2_windows_dynamic_driver_loading"></a>
16.2. Windows Dynamic Driver Loading</h1>
<p >Windows 7 and higher uses Windows Driver Model (WDM) drivers - files with the extension *.sys (e.g., <code>windrvr1511.sys</code>). WDM drivers are installed via the installation of an INF file (see below).</p>
<p >The WinDriver Windows kernel module — <code>windrvr1511.sys</code> — is a fully WDM driver, which can be installed using the wdreg utility, as explained in the following sections.</p>
<h2><a class="anchor" id="ch16_2_1_the_wdreg_utility"></a>
16.2.1. The wdreg Utility</h2>
<p >WinDriver provides a utility for dynamically loading and unloading your driver, which replaces the slower manual process using Windows' Device Manager (which can still be used for the device INF). This utility is provided in two forms: <b>wdreg</b> and <b>wdreg_gui</b>.</p>
<p >Both versions can be found in the <code>WinDriver\util</code> directory, they can be run from the command line, and provide the same functionality. The difference is that <code>wdreg_gui</code> displays installation messages graphically, while wdreg displays them in console mode.</p>
<p >This section describes the use of <code>wdreg</code> / <code>wdreg_gui</code> on Windows operating systems.</p>
<p >wdreg is dependent on <code>devcon.exe</code>.</p>
<p >The explanations and examples below refer to <code>wdreg</code>, but any references to wdreg can be replaced with <code>wdreg_gui</code>.</p>
<h3><a class="anchor" id="ch16_2_1_1_wdm_drivers_the_wdreg_utility"></a>
16.2.1.1. WDM Drivers</h3>
<p >This section explains how to use the <code>wdreg</code> utility to install the WDM <code>windrvr1511.sys</code> driver, or to install INF files that register Plug-and-Play devices to work with this driver, on Windows. You can rename the <code>windrvr1511.sys</code> kernel module and modify your device INF file to register with your renamed driver, as explained in <a class="el" href="ch17_driver_installation_advanced_issues.html#ch17_2_1_windows_driver_renaming">17.2.1. Windows Driver Renaming</a>.</p>
<p >To install your modified INF files using <code>wdreg</code>, simply replace any references to <code>windrvr1511</code> below with the name of your new driver.</p>
<p >This section is not relevant for Kernel PlugIn drivers, since these are not WDM drivers and are not installed via an INF file. For an explanation on how to use wdreg to install Kernel PlugIn drivers on Windows, refer to <a class="el" href="ch16_dynamically_loading_your_driver.html#ch16_2_1_2_non-wdm_drivers">16.2.1.2. Non-WDM Drivers</a>.</p>
<p >Usage: The wdreg utility can be used in two ways as demonstrated below:</p>
<div class="fragment"><div class="line">wdreg -inf &lt;filename&gt; [-silent] [-log &lt;logfile&gt;] [install | preinstall | uninstall | enable | disable]</div>
<div class="line">wdreg -rescan &lt;enumerator&gt; [-silent] [-log &lt;logfile&gt;]</div>
</div><!-- fragment --><p ><b>OPTIONS</b> <code>wdreg</code> supports several basic OPTIONS from which you can choose one, some, or none:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Options &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>-inf</code>   </td><td class="markdownTableBodyLeft">The path of the INF file to be dynamically installed.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>-rescan &lt;enumerator&gt;</code>   </td><td class="markdownTableBodyLeft">Rescan enumerator (ROOT, ACPI, PCI, USB, etc.) for hardware changes. Only one enumerator can be specified.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>-silent</code>   </td><td class="markdownTableBodyLeft">Suppress display of all messages (optional).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>-log &lt;logfile&gt;</code>   </td><td class="markdownTableBodyLeft">Log all messages to the specified file (optional).   </td></tr>
</table>
<p ><b>ACTIONS</b> <code>wdreg</code> supports several basic ACTIONS:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Action &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>install</code>   </td><td class="markdownTableBodyLeft">Installs the INF file, copies the relevant files to their target locations, and dynamically loads the driver specified in the INF file name by replacing the older version (if needed).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>preinstall</code>   </td><td class="markdownTableBodyLeft">Pre-installs the INF file for a non-present device.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>uninstall</code>   </td><td class="markdownTableBodyLeft">Removes your driver from the registry so that it will not load on next boot (see note below).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>enable</code>   </td><td class="markdownTableBodyLeft">Enables your driver.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>disable</code>   </td><td class="markdownTableBodyLeft">Disables your driver, i.e., dynamically unloads it, but the driver will reload after system boot (see note below).   </td></tr>
</table>
<p >To successfully disable/uninstall your driver, make sure that there are no open handles to the WinDriver service (<code>windrvr1511.sys</code> or your renamed driver), and that there are no connected and enabled Plug-and-Play devices that are registered with this service.</p>
<h3><a class="anchor" id="ch16_2_1_2_non-wdm_drivers"></a>
16.2.1.2. Non-WDM Drivers</h3>
<p >This section explains how to use the wdreg utility to install non-WDM drivers, namely Kernel PlugIn drivers, on Windows.</p>
<p >During development stages, it may be useful to use the wdreg_frontend GUI utility to quickly install/uninstall Kernel PlugIns. </p><div class="fragment"><div class="line">USAGE: </div>
<div class="line">wdreg [-file &lt;filename&gt;] [-name &lt;drivername&gt;] [-startup &lt;level&gt;] [-silent] [-log &lt;logfile&gt;] Action [Action ...]</div>
</div><!-- fragment --><p ><b>OPTIONS</b> wdreg supports several basic OPTIONS from which you can choose one, some, or none:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>-startup</code>   </td><td class="markdownTableBodyLeft">Specifies when to start the driver. Requires one of the following arguments: <br  />
 <code>-boot</code>: Indicates a driver started by the operating system loader, and should only be used for drivers that are essential to loading the OS (for example, Atdisk). <br  />
 <code>-system</code>: Indicates a driver started during OS initialization. <br  />
 <code>-automatic</code>: Indicates a driver started by the Service Control Manager during system startup. <br  />
 <code>-demand</code>: Indicates a driver started by the Service Control Manager on demand (i.e., when your device is plugged in). <br  />
 <code>-disabled</code>: Indicates a driver that cannot be started. <br  />
 The default setting for the <code>-startup</code> option is automatic. <br  />
    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>-name</code>   </td><td class="markdownTableBodyLeft">Sets the symbolic name of the driver. This name is used by the user-mode application to get a handle to the driver. You must provide the driver's symbolic name (without the *.sys extension) as an argument with this option. The argument should be equivalent to the driver name as set in the KP_Init function of your Kernel PlugIn project: <code>strcpy(kpInit-&gt;cDriverName, XXX_DRIVER_NAME)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>-file</code>   </td><td class="markdownTableBodyLeft"><code>wdreg</code> allows you to install your driver in the registry under a different name than the physical file name. This option sets the file name of the driver. You must provide the driver's file name (without the *.sys extension) as an argument. wdreg looks for the driver in the Windows installation directory <code>(windir%\system32\drivers)</code>. Therefore, you should verify that the driver file is located in the correct directory before attempting to install the driver.   </td></tr>
</table>
<div class="fragment"><div class="line">USAGE:</div>
<div class="line">wdreg -name &lt;Your new driver name&gt; -file &lt;Your original driver name&gt; install </div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Flag   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>-silent</code>   </td><td class="markdownTableBodyLeft">Suppresses the display of messages of any kind.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>-log &lt;logfile&gt;</code>   </td><td class="markdownTableBodyLeft">Logs all messages to the specified file.   </td></tr>
</table>
<p ><b>ACTIONS</b> wdreg supports several basic ACTIONS:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Action   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>create</code>   </td><td class="markdownTableBodyLeft">Instructs Windows to load your driver next time it boots, by adding your driver to the registry.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>delete</code>   </td><td class="markdownTableBodyLeft">Removes your driver from the registry so that it will not load on next boot.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>start</code>   </td><td class="markdownTableBodyLeft">Dynamically loads your driver into memory for use. You must create your driver before starting it.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>stop</code>   </td><td class="markdownTableBodyLeft">Dynamically unloads your driver from memory.   </td></tr>
</table>
<p ><b>Shortcuts</b> wdreg supports a few shortcut operations for your convenience:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Shortcut &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>install</code>   </td><td class="markdownTableBodyLeft">Creates and starts your driver. This is the same as first using the wdreg stop action (if a version of the driver is currently loaded) or the <code>wdreg</code> create action (if no version of the driver is currently loaded), and then the wdreg start action.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>preinstall</code>   </td><td class="markdownTableBodyLeft">Creates and starts your driver for a non-connected device.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>uninstall</code>   </td><td class="markdownTableBodyLeft">Unloads your driver from memory and removes it from the registry so that it will not load on next boot. This is the same as first using the <code>wdreg</code> stop action and then the wdreg delete action.   </td></tr>
</table>
<h2><a class="anchor" id="ch16_2_2_dynamically_loading-unloading_windrvr_sys_inf_files"></a>
16.2.2. Dynamically Loading/Unloading windrvr1511.sys INF Files</h2>
<p >When using WinDriver, you develop a user-mode application that controls and accesses your hardware by using the generic <code>windrvr1511.sys</code> driver (WinDriver's kernel module). Therefore, you might want to dynamically load and unload the driver <code>windrvr1511.sys</code> — which you can do using wdreg.</p>
<p >In addition, in WDM-compatible operating systems, you also need to dynamically load INF files for your Plug-and-Play devices. wdreg enables you to do so automatically on Windows. This section includes wdreg usage examples, which are based on the detailed description of wdreg contained in the previous section.</p>
<p ><b>Examples</b>:</p>
<p >To load <code>windrvr1511.inf</code> and start the <code>windrvr1511.sys</code> service — <code>wdreg -inf &lt;path to windrvr1511@.inf&gt; install</code> To load an INF file named <code>device.inf</code>, located in the <code>c:\tm</code>p directory — <code>wdreg -inf c:\tmp\device.inf install</code></p>
<p >You can replace the install option in the example above with preinstall to pre-install the device INF file for a device that is not currently connected to the PC.</p>
<p >If the installation fails with an <code>ERROR_FILE_NOT_FOUND</code> error, inspect the Windows registry to see if the RunOnce key exists in <code>HKEY_LOCAL_MACHINE\SOFTWARE \Microsoft\Windows\CurrentVersion</code>. This registry key is required by Windows Plug-and-Play in order to properly install drivers using INF files. If the <code>RunOnce</code> key is missing, create it; then try installing the INF file again.</p>
<p >To unload the driver/INF file, use the same commands, but simply replace install in the examples above with uninstall.</p>
<h2><a class="anchor" id="ch16_2_3_dynamically_loading-unloading_your_kernel_plugin_driver_windows"></a>
16.2.3. Dynamically Loading/Unloading Your Kernel PlugIn Driver</h2>
<p >If you used WinDriver to develop a Kernel PlugIn driver, you must load this driver only after loading the generic WinDriver driver — <code>windrvr1511.sys</code>.</p>
<p >When unloading the drivers, unload your Kernel PlugIn driver before unloading <code>windrvr1511.sys</code>.</p>
<p >Kernel PlugIn drivers are dynamically loadable — i.e., they can be loaded and unloaded without reboot. To load/unload your Kernel PlugIn driver (XXX_DRIVER_NAME.sys) use the wdreg command as described above for <code>windrvr1511</code>, with the addition of the <code>name</code> flag, after which you must add the name of your Kernel PlugIn driver.</p>
<blockquote class="doxtable">
<p >&zwj;<b>⚠ Attention</b></p>
<blockquote class="doxtable">
<p >&zwj;You should not add the *.sys extension to the driver name. </p>
</blockquote>
</blockquote>
<blockquote class="doxtable">
<p >&zwj;<b>💡 Recommendation</b></p>
<blockquote class="doxtable">
<p >&zwj;During development stages, it may be useful to use the wdreg_frontend GUI utility to quickly install/uninstall Kernel PlugIns. </p>
</blockquote>
</blockquote>
<p><b>Examples</b>:</p>
<ul>
<li>To load a Kernel PlugIn driver called KPDriver.sys, run this command:</li>
</ul>
<div class="fragment"><div class="line">wdreg -name KPDriver install</div>
</div><!-- fragment --><ul>
<li>To load a Kernel PlugIn driver called MPEG_Encoder, with file name MPEGENC.sys, run this command:</li>
</ul>
<div class="fragment"><div class="line">wdreg -name MPEG_Encoder -file MPEGENC install</div>
</div><!-- fragment --><ul>
<li>To uninstall a Kernel PlugIn driver called KPDriver.sys, run this command:</li>
</ul>
<div class="fragment"><div class="line">wdreg -name KPDriver uninstall</div>
</div><!-- fragment --><ul>
<li>To uninstall a Kernel PlugIn driver called MPEG_Encoder, with file name MPEGENC.sys, run this command:</li>
</ul>
<div class="fragment"><div class="line">wdreg -name MPEG_Encoder -file MPEGENC uninstall</div>
</div><!-- fragment --><h1><a class="anchor" id="ch16_3_the_wdreg_frontend_utility"></a>
16.3. The wdreg_frontend utility</h1>
<p >Under Windows, WinDriver features a GUI frontend utility that is designed to ease installataion / uninstallation of WinDriver and Kernel PlugIn drivers during development phases.</p>
<p >Every operation that can be performed with wdreg can also be performend from wdreg_frontend and their output is identical. wdreg_frontend prints out the complete wdreg command that it performed, making it easier for the developer to copy the desired command and integrate it in their own installation scripts.</p>
<blockquote class="doxtable">
<p >&zwj;<b>⚠ Attention</b></p>
<blockquote class="doxtable">
<p >&zwj;Driver installation on Windows requires administrator privileges. </p>
</blockquote>
</blockquote>
<p>Loading <code>wdreg_frontend</code>:</p>
<p ><b>The wdreg_frontend icon</b></p>
<div class="image">
<img src="frontend_icon.jpg" alt=""/>
</div>
 <p >Click the wdreg_frontend icon from the DriverWizard window, and then run <code>WinDriver/util/wdreg_frontend.exe</code> directly.</p>
<p >To load/unload a Kernel Plugin:</p>
<p ><b>The dialog box wdreg_frontend will open if driver file is not located in the Windows system directory</b></p>
<div class="image">
<img src="copy_driver_file.png" alt=""/>
</div>
 <p ><b>wdreg_frontend after successfully loading a sys file</b></p>
<div class="image">
<img src="load_driver.png" alt=""/>
</div>
 <p >Click <b>File</b> | <b>Open</b> and open the desired sys file. If the sys file is not located in the Windows system directory, a dialog box will appear and ask if you wish wdreg_frontend to copy the sys file to the Windows system directory. If the file loaded correctly, all actions available for .sys files will become enabled: Install Driver, Uninstall Driver, Start Driver, Stop Driver, Create Driver, Delete Driver and choice of Startup level.</p>
<p >Further information on these actions is available on the wdreg <a class="el" href="ch16_dynamically_loading_your_driver.html#ch16_2_1_2_non-wdm_drivers">16.2.1.2. Non-WDM Drivers</a> of this document:</p>
<p ><b>Error message given by Windows when trying to install an unsigned driver</b></p>
<div class="image">
<img src="digital_sign_fail.png" alt=""/>
</div>
 <p >You may need to either digitally sign your sys file or disable digital signature enforcement for the driver to properly load and work under Windows.</p>
<p >To install/uninstall an INF file:</p>
<ul>
<li>Click <b>File</b> | <b>Open</b> and open the desired sys file.</li>
<li>If the file loaded correctly, all actions available for .inf files will become enabled: Install Driver, Uninstall Driver, Enable Driver, Disable Driver, Preinstall Driver.</li>
</ul>
<p ><b>wdreg_frontend upon successfully installing a sys driver</b></p>
<div class="image">
<img src="driver_install_success.png" alt=""/>
</div>
 <h1><a class="anchor" id="ch16_4_linux_dynamic_driver_loading"></a>
16.4. Linux Dynamic Driver Loading</h1>
<blockquote class="doxtable">
<p >&zwj;<b>⚠ Attention</b></p>
<blockquote class="doxtable">
<p >&zwj;The following commands must be executed with root privileges. </p>
</blockquote>
</blockquote>
<p>To dynamically load WinDriver, run the following command:</p>
<div class="fragment"><div class="line"># &lt;path to wdreg&gt; windrvr1511 </div>
</div><!-- fragment --><p >To dynamically unload WinDriver, run the following command:</p>
<div class="fragment"><div class="line"># /sbin/modprobe -r windrvr1511.</div>
</div><!-- fragment --><p >wdreg is provided in the WinDriver/util directory.</p>
<p >To automatically load WinDriver on each boot, add the following line to the target's Linux boot file (for example, <code>/etc/rc.local</code>):</p>
<div class="fragment"><div class="line">&lt;path to wdreg&gt; windrvr1511</div>
</div><!-- fragment --><h2><a class="anchor" id="ch16_4_1_dynamically_loading-unloading_your_kernel_plugin_driver_linux"></a>
16.4.1. Dynamically Loading/Unloading Your Kernel PlugIn Driver</h2>
<p >If you used WinDriver to develop a Kernel PlugIn driver, you must load this driver only after loading the generic WinDriver driver — <code>windrvr1511.o/.ko</code>.</p>
<p >When unloading the drivers, unload your Kernel PlugIn driver before unloading <code>windrvr1511.o/.ko</code>.</p>
<p >Kernel PlugIn drivers are dynamically loadable — i.e., they can be loaded and unloaded without reboot. Use the following commands to dynamically load or unload your Kernel PlugIn driver.</p>
<blockquote class="doxtable">
<p >&zwj;<b>⚠ Attention</b></p>
<blockquote class="doxtable">
<p >&zwj;The following commands must be executed with root privileges. </p>
</blockquote>
</blockquote>
<p>xxx in the commands signifies your selected Kernel PlugIn driver project name.</p>
<p >To dynamically load your Kernel PlugIn driver, run this command:</p>
<div class="fragment"><div class="line"># /sbin/insmod &lt;path to kp_xxx_module.o/.ko&gt;</div>
</div><!-- fragment --><p >When building the Kernel PlugIn driver on the development machine, the Kernel PlugIn driver module is created in your Kernel PlugIn project's <code>kermode/linux/LINUX.&lt;kernel version&gt;.&lt;CPU&gt;</code> directory (see <a class="el" href="ch13_creating_a_kernel_plugin_driver.html#ch13_8_2_linux_kernel_plugin_driver_compilation">13.8.2. Linux Kernel PlugIn Driver Compilation</a>). When building the driver on a target distribution machine, the driver module is normally created in an <code>xxx_installation/redist/LINUX.&lt;kernel version&gt;.&lt;CPU&gt;.KP</code> directory (see <a class="el" href="ch15_distributing_your_driver.html#ch15_3_3_building_and_installing_your_kernel_plugin_driver_on_the_target">15.3.3. Building and Installing Your Kernel PlugIn Driver on the Target</a>).</p>
<p >To dynamically unload your Kernel PlugIn, run this command:</p>
<div class="fragment"><div class="line"># /sbin/rmmod kp_xxx_module</div>
</div><!-- fragment --><p >To automatically load your Kernel PlugIn driver on each boot, add the following line to the target's Linux boot file (for example, <code>/etc/rc.local</code>), after the WinDriver driver module (<code>windrvr1511</code>) load command (replace &lt;path to kp_xxx_module.o/.ko&gt; with the path to your Kernel PlugIn driver module):</p>
<div class="fragment"><div class="line">/sbin/insmod &lt;path to kp_xxx_module.o/.ko&gt; </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
