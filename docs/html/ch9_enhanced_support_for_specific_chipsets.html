<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110109-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-110109-1');
</script>
<script type="text/javascript" src="../common/version.js"></script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="Chapter 9: Enhanced Support for Specific Chipsets"/>
<title>Jungo WinDriver: Chapter 9: Enhanced Support for Specific Chipsets</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-main.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="wd_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Jungo WinDriver
   &#160;
   <span id="projectnumber"></span>
   </div>
   <div id="projectbrief">Official Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ch9_enhanced_support_for_specific_chipsets.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Chapter 9: Enhanced Support for Specific Chipsets </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_chap09"></a> </p>
<h1><a class="anchor" id="ch9_1_enhanced_support_for_specific_chipsets_overview"></a>
9.1. Enhanced Support for Specific Chipsets Overview</h1>
<p >In addition to the standard WinDriver APIs and the DriverWizard code generation capabilities described in this manual, which support development of drivers for any PCI/ISA device, WinDriver features enhanced support for specific PCI chipsets. This enhanced support includes custom APIs, customized code generation (for some of the chipsets), and sample diagnostics code, which are all designed specifically for these chipsets.</p>
<p >WinDriver's enhanced support is currently available for the following PCI chipsets: PLX 6466, 9030, 9050, 9052, 9054, 9056, 9080 and 9656; Altera Qsys design; Xilinx BMD, XDMA, QDMA designs.</p>
<p >Customized code generation is available for the Altera Qsys design, Xilinx BMD, XDMA, QDMA designs chipsets.</p>
<h1><a class="anchor" id="ch9_2_developing_a_driver_using_the_enhanced_chipset_support"></a>
9.2. Developing a Driver Using the Enhanced Chipset Support</h1>
<p >When developing a driver for a device based on one of the enhanced-support chipsets described above, you can use WinDriver's chipset-set specific support in the following manner: if your device is based on the Altera Qsys, Avalon-MM designs, Xilinx BMD, XDMA, QDMA designs, you can generate customized code for the device by selecting this option in the DriverWizard code generation options dialogue (see <a class="el" href="ch6_using_driverwizard.html#ch6_2_driverwizard_walkthrough">6.2. DriverWizard Walkthrough</a>). Alternatively, or if you are using another enhanced-support device, follow the steps below to use one the enhanced-support WinDriver samples as the starting point for your development:</p>
<ul>
<li>Locate the sample diagnostics program for your device under the <br  />
 <code>WinDriver/samples/language/chip_vendor/chip_name</code> directory.</li>
</ul>
<p >Most of the sample diagnostics programs are named <code>xxx_diag</code> and their source code is normally found under an <code>xxx_diag</code> subdirectory. The program's executable is found under a subdirectory for your target operating system (e.g., <code>WIN32</code> for Windows.)</p>
<ul>
<li>Run the custom diagnostics program to diagnose your device and familiarize yourself with the options provided by the sample program.</li>
<li>Use the source code of the diagnostics program as your skeletal device driver and modify the code, as needed, to suit your specific development needs. When modifying the code, you can utilize the custom WinDriver API for your specific chip. The custom API is typically found under the <code>WinDriver/samples/language/chip_vendor/lib</code> directory.</li>
<li>If the user-mode driver application that you created by following the steps above contains parts that require enhanced performance (e.g., an interrupt handler), you can move the relevant portions of your code to a Kernel PlugIn driver for optimal performance, as explained in <a class="el" href="ch11_improving_pci_performance.html">Chapter 11: Improving PCI Performance</a>.</li>
</ul>
<h1><a class="anchor" id="ch9_3_the_xdma_sample_code"></a>
9.3. The XDMA sample code</h1>
<p >Starting from version 12.3, WinDriver supplies a user-mode sample code of a diagnostic utility that demonstrates several features of Xilinx PCI Express cards programmed with a Xilinx DMA IP.</p>
<p >The sample source code and the pre-compiled sample can be found in the <br  />
 <code>WinDriver/samples/c/xilinx/xdma</code> directory.</p>
<p >Before running the diagnostic utility, make sure that DriverWizard is closed, to avoid a “resource overlap” error.</p>
<blockquote class="doxtable">
<p >&zwj;<b>⚠ Attention</b></p>
<blockquote class="doxtable">
<p >&zwj;If you have a proper XDMA supporting device attached, the diagnostic utility might open it automatically on startup, as shown here. Otherwise, you can choose option 2 and to try to open a device yourself. </p>
</blockquote>
</blockquote>
<p><b>The xdma_diag utility</b></p>
<div class="image">
<img src="xdma_diag_1.jpg" alt=""/>
</div>
 <h2><a class="anchor" id="ch9_3_1_performing_direct_memory_access_dma_tests"></a>
9.3.1. Performing Direct Memory Access (DMA) tests</h2>
<p >After choosing option 6 from the XDMA main menu, the user can either Perform a DMA transfer or Measure DMA Performance.</p>
<p >The DMA transfer option allows the user to actually read or write data from device.</p>
<p >The writing option prompts the user to type a hexadecimal 32 bit packet of data, and this packet is repeatedly written to the device’s memory, according to the user entered Number of packets to transfer. The reading option prints out the contents of a certain memory area, according to the user entered FPGA offset.</p>
<p >A simple test can be:</p>
<ul>
<li>Writing a certain 32 bit packet to the device’s memory.</li>
<li>Reading from the same offset and making sure whether the data previously written to the device is in fact the data that is now read.</li>
</ul>
<p ><b>XDMA Transfer example</b></p>
<div class="image">
<img src="xdma_diag_transfer.jpg" alt=""/>
</div>
 <p >The DMA performance option allows the user to test the speed of the device. The user is prompted to choose a transfer direction (to device, from device, or simultaneous bi-directional transfers). Then the user is prompted to enter a buffer size for the each transfer that will be made during the test, and the test’s duration. Afterwards the test takes place and in the end of the test the results will be printed out.</p>
<p ><b>XDMA Performance test example</b></p>
<div class="image">
<img src="xdma_diag_performance.jpg" alt=""/>
</div>
 <h2><a class="anchor" id="ch9_3_2_the_xdma_gui_utility"></a>
9.3.2. The XDMA GUI utility</h2>
<p >Starting from WinDriver version 12.5, WinDriver also supplies a GUI utility, based upon the same <code>xdma_diag</code> source code, showcasing the above mentioned DMA Transfer and DMA Performance tests. The <code>xdma_gui</code> utility can be found in the <code>WinDriver/samples/c/xilinx/xdma/gui</code> directory. Similar to the console <code>xdma_diag</code> program, the <code>xdma_gui</code> utility will try to open an XDMA device automatically, and if it will fail then it will be required to first select and open an XDMA-supported device before being able to perform the tests.</p>
<p ><b>The xdma_gui Utility</b></p>
<div class="image">
<img src="xdma_gui_startup.jpg" alt=""/>
</div>
 <p ><b>DMA Transfer test in xdma_gui</b></p>
<div class="image">
<img src="xdma_gui_transfer.jpg" alt=""/>
</div>
 <p ><b>DMA Performance in the xdma_gui Utility</b></p>
<div class="image">
<img src="xdma_gui_performance.jpg" alt=""/>
</div>
 <h2><a class="anchor" id="ch9_3_3_xdma_code_generation_in_driverwizard"></a>
9.3.3. XDMA code generation in DriverWizard</h2>
<p >Starting from WinDriver version 12.5, DriverWizard allows generating a user-mode diagnostics program source code that is similar to the supplied <code>xdma_diag</code> program, by choosing Xilinx XDMA design from the <code>Add device specific customization (optional)</code> menu.</p>
<p ><b>Code Generation with XDMA device specific customization</b></p>
<div class="image">
<img src="xdma_codegen.jpg" alt=""/>
</div>
 <h1><a class="anchor" id="ch9_4_the_qdma_sample_code"></a>
9.4. The QDMA sample code</h1>
<p >Starting from version 14.4 WinDriver supplies a cross-platform user-mode sample code of a diagnostic utility that demonstrates several features of Xilinx PCI Express cards with QDMA IP (Multi Queue DMA) support.</p>
<p >The sample source code and the pre-compiled sample can be found in the <br  />
 <code>WinDriver/samples/c/xilinx/qdma</code> directory.</p>
<p >Before running the diagnostic utility, make sure that DriverWizard is closed, to avoid a “resource overlap” error.</p>
<blockquote class="doxtable">
<p >&zwj;<b>⚠ Attention</b></p>
<blockquote class="doxtable">
<p >&zwj;If you have a QDMA supporting device attached, the diagnostic utility will open it automatically on startup. Or you can choose “Find and open a QDMA device” option to try to open a device yourself. </p>
</blockquote>
</blockquote>
<h2><a class="anchor" id="ch9_4_1_performing_direct_memory_access_dma_transaction"></a>
9.4.1. Performing Direct Memory Access (DMA) transaction</h2>
<p >After choosing “Direct Memory Access (DMA) transaction” option, the user can either Perform a DMA transaction. The DMA transaction option allows the user to actually read or write data from device.</p>
<p >In order to do this you will need to:</p>
<ul>
<li>Add a MM queue.</li>
<li>Start a MM queue.</li>
<li>Create a read request or write request.</li>
</ul>
<p >If you selected Blocking method you can see the transaction details (including transaction rate) when it is finished, otherwise (Non-blocking method), you can see it in the Requests sub-menu.</p>
<h2><a class="anchor" id="ch9_4_2_changing_between_physical_functions"></a>
9.4.2. Changing between physical functions</h2>
<p >Several QDMA devices can be opened simultaneously. To switch between physical functions select “Change physical function” in the menu.</p>
<h2><a class="anchor" id="ch9_4_3_requests_info"></a>
9.4.3. Requests info</h2>
<p >The following actions may be done on the Requests menu:</p>
<ul>
<li>Show requests list (read and write requests).</li>
<li>Show buffer content.</li>
<li>Delete request from list (Including free for the assigned buffer of the request).</li>
<li>Get status of all queues.</li>
</ul>
<p >In order to get queues status (Available/Programmed/Started), select “Get queue status”.</p>
<h2><a class="anchor" id="ch9_4_4_qdma_code_generation_in_driverwizard"></a>
9.4.4. QDMA code generation in DriverWizard</h2>
<p >Starting from WinDriver version 14.4, DriverWizard allows generating a user-mode diagnostics program source code that is similar to the supplied <code>qdma_diag</code> program, by choosing Xilinx QDMA design from the “Add device specific customization” (optional) menu.</p>
<p ><b>Code Generation with QDMA</b></p>
<div class="image">
<img src="qdma.jpg" alt=""/>
</div>
 <h1><a class="anchor" id="ch9_5_the_avalon-mm_sample_code"></a>
9.5. The Avalon-MM sample code</h1>
<p >Starting from version 14.7, WinDriver supplies a user-mode sample code of a diagnostic utility that demonstrates several features of Intel Altera PCI Express cards programmed with a Avalon-MM IP.</p>
<p >The sample source code and the pre-compiled sample can be found in the <br  />
 <code>WinDriver/samples/c/altera/avalonmm</code> directory.</p>
<h2><a class="anchor" id="ch9_5_1_avalon-mm_code_generation_in_driverwizard"></a>
9.5.1. Avalon-MM code generation in DriverWizard</h2>
<p >DriverWizard allows generating a user-mode diagnostics program source code that is similar to the supplied <code>avalonmm_diag</code> program, by choosing Altera Avalon Memory Mapped (Avalon-MM) design from the <code>Add device specific customization (optional)</code> menu.</p>
<p ><b>Code Generation with Altera Avalon Memory Mapped (Avalon-MM) device specific customization</b></p>
<div class="image">
<img src="avalon_mm_codegen.jpg" alt=""/>
</div>
  </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
