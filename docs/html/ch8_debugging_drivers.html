<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110109-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-110109-1');
</script>
<script type="text/javascript" src="../common/version.js"></script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="Chapter 8: Debugging Drivers"/>
<title>Jungo WinDriver: Chapter 8: Debugging Drivers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-main.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="wd_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Jungo WinDriver
   &#160;
   <span id="projectnumber"></span>
   </div>
   <div id="projectbrief">Official Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ch8_debugging_drivers.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Chapter 8: Debugging Drivers </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_chap08"></a>The following sections describe how to debug your hardware-access application code.</p>
<h1><a class="anchor" id="ch8_1_user-mode_debugging"></a>
8.1. User-Mode Debugging</h1>
<p >Since WinDriver is accessed from the user mode, we recommend that you first debug your code using your standard debugging software, such as the compiler’s debugger.</p>
<p >Debug Monitor is a powerful graphical- and console-mode tool for monitoring all activities handled by the WinDriver kernel. You can use this tool to monitor how each command sent to the kernel is executed.</p>
<p >In addition, WinDriver enables you to print your own debug messages to the Debug Monitor, using the <a class="el" href="windrvr_8h_a8e65c66178d0a60a95a5c789eca9aac9.html#a8e65c66178d0a60a95a5c789eca9aac9" title="Sends debug messages to the debug log.">WD_DebugAdd()</a> function or the high-level <a class="el" href="utils_8h_a1c9e243fd81353f2dfc14f799254295e.html#a1c9e243fd81353f2dfc14f799254295e" title="Sends debug messages to the Debug Monitor.">PrintDbgMessage()</a> function. Note that this function can be called from both user-mode and kernel-mode code (created using WinDriver’s Kernel PlugIn feature) and can also be called from within functions running at HIGH IRQL, such as the Kernel PlugIn <a class="el" href="kp__pci_8c_a766459ac39112e0692658ec3e3597712.html#a766459ac39112e0692658ec3e3597712">KP_IntAtIrql()</a> function.</p>
<p >The Debug Monitor comes in two versions:</p>
<ul>
<li><code>wddebug_gui</code> — a GUI version</li>
<li><code>wddebug</code> — a console-mode version</li>
</ul>
<p >Note that <code>wddebug_gui</code> is available for all supported Desktop operating system but is currently not available for Linux ARM/ARM64. For these platforms, use the console-mode <code>wddebug</code>.</p>
<p >Both Debug Monitor versions are provided in the <code>WinDriver/util</code> directory.</p>
<p >Please note that <a class="el" href="windrvr_8h_a8e65c66178d0a60a95a5c789eca9aac9.html#a8e65c66178d0a60a95a5c789eca9aac9" title="Sends debug messages to the debug log.">WD_DebugAdd()</a> function can be called from both user-mode and kernel-mode code (created using WinDriver’s Kernel PlugIn feature) and can also be called from within functions running at HIGH IRQL, such as the Kernel PlugIn KP_IntAtIrql() function.</p>
<p >You can also select to send the debug messages to a kernel debugger, instead of to the Debug Monitor log, as we explain further. This can enable you, for example, to log the debug message on another PC in case the system crashes (BSOD) or hangs on the development PC.</p>
<p >Most of the WinDriver functions have a return value to indicate success or a relevant error code, which can assist you in the debugging process. The return status codes are defined in the [WD_ERROR_CODES] (<a class="el" href="windrvr_8h_a4be61f088cf6870c6ff37ab94aba215c.html#a4be61f088cf6870c6ff37ab94aba215c">WD_ERROR_CODES</a>) enum.</p>
<p >When developing code in the kernel using the Kernel PlugIn, you can also use any kernel debugger in the debugging process (e.g., WinDbg — which is distributed with the Windows Driver Kit (WDK) and is part of the Debugging Tools for Windows package, distributed via the Microsoft website). As mentioned above, you can also select to direct the debug message from the Debug Monitor to a kernel debugger of your choice.</p>
<h1><a class="anchor" id="ch8_2_debug_monitor"></a>
8.2. Debug Monitor</h1>
<p >The Debug Monitor utility logs debug messages from WinDriver's kernel-mode and usermode APIs. You can also use WinDriver APIs to send your own debug messages to the Debug Monitor log.</p>
<p >When using WinDriver's API (such as <a class="el" href="windrvr_8h_ac7801059e5aee0b0a5f314f96bd72603.html#ac7801059e5aee0b0a5f314f96bd72603" title="Executes a single read/write instruction to an I/O port or to a memory address.">WD_Transfer()</a>), to read/write memory ranges on the card in the kernel, while the Debug Monitor is activated, WinDriver's kernel module validates the memory ranges, i.e., it verifies that the reading/writing from/to the memory is in the range that is defined for the card.</p>
<p >Use DriverWizard to check values of memory, registers and configuration in the debugging process.</p>
<h2><a class="anchor" id="ch8_2_1_the_wddebug_gui_utility"></a>
8.2.1. The wddebug_gui Utility</h2>
<p ><code>wddebug_gui</code> is a fully graphical (GUI) version of the Debug Monitor utility for Windows and Linux.</p>
<ul>
<li>Run the Debug Monitor using either of the following methods:<ul>
<li>Run <code>WinDriver/util/wddebug_gui</code>.</li>
<li>Run the Debug Monitor from DriverWizard's Tools menu.</li>
<li>On Windows, choose <b>Start</b> | <b>Programs</b> | <b>WinDriver</b> | <b>Debug Monitor</b>.</li>
</ul>
</li>
</ul>
<p ><b>Start Debug Monitor</b></p>
<div class="image">
<img src="dbgm_log.png" alt=""/>
</div>
 <ul>
<li>Set the Debug Monitor's status, trace level and debug sections information from the <b>Debug Options</b> dialogue, which is activated either from the Debug Monitor's <b>View</b> | <b>Debug Options</b> menu or the <b>Debug Options</b> toolbar button.</li>
</ul>
<p ><b>Debug Options</b></p>
<div class="image">
<img src="dbgm_dbg_opts.png" alt=""/>
</div>
 <p ><b>Status</b> — Set trace on or off. <b>Section</b> — Choose what part of the WinDriver API you would like to monitor.</p>
<p >For example, if you are experiencing problems with the interrupt handler on your PCI card, select the PCI and Interrupts sections. USB developers should select the USB section.</p>
<p >Choose carefully those sections that you would like to monitor. Checking more options than necessary could result in an overflow of information, making it harder for you to locate your problem.</p>
<p ><b>Level</b> — Choose the level of messages you want to see for the resources defined. Error is the lowest trace level, resulting in minimum output to the screen. Trace is the highest trace level, displaying every operation the WinDriver kernel performs. <b>Send debug messages to the operating system kernel debugger</b> — Select this option to send the debug messages received from the WinDriver kernel module to an external kernel debugger, in addition to the Debug Monitor.</p>
<p >On Windows, the first time that you enable this option you will need to restart the PC. A free Windows kernel debugger, WinDbg, is distributed with the Windows Driver Kit (WDK) and is part of the Debugging Tools for Windows package, distributed via the Microsoft web site. <b>Driver Name</b> — This field displays the name of the driver currently being debugged. Changing it allows you to debug a renamed WinDriver driver.</p>
<ul>
<li>Once you have defined what you want to trace and on what level, click <b>OK</b> to close the <b>Debug Options</b> window.</li>
<li>Optionally make additional configurations via the Debug Monitor menus and toolbar.</li>
</ul>
<p >When debugging OS crashes or hangs, it's useful to auto-save the Debug Monitor log, via the <b>File</b> | <b>Toggle Auto-Save</b> menu option (available also via a toolbar icon), in addition to sending the debug messages to the OS kernel debugger.</p>
<ul>
<li>Run your application (step-by-step or in one run).</li>
</ul>
<p >You can use the <b>Edit</b> | <b>Add Custom Message...</b> menu option (available also via a toolbar icon) to add custom messages to the log. This is especially useful for clearly marking different execution sections in the log.</p>
<ul>
<li>Watch the Debug Monitor log (or the kernel debugger log, if enabled) for errors or any unexpected messages.</li>
</ul>
<h3><a class="anchor" id="ch8_2_1_1_search_in_wddebug_gui"></a>
8.2.1.1. Search in wddebug_gui</h3>
<p ><code>wddebug_gui</code> allows to find expressions in the Debug output in 4 ways:</p>
<ul>
<li>Starting to type an expression with the keyboard immediately searches for it in the Debug output.</li>
<li>Pressing CTRL+F displays the Find field in the toolbar.</li>
<li>Clicking the Find icon in the toolbar.</li>
<li>Going to <b>Edit</b> | <b>Find...</b></li>
</ul>
<p >If an expression is found it is marked. It is possible to browse between occurences of an expression using <b>Prev (F2)</b> and <b>Next (F3)</b>.</p>
<p ><b>Search in wddebug_gui</b></p>
<div class="image">
<img src="dbgm_find.png" alt=""/>
</div>
 <h3><a class="anchor" id="ch8_2_1_2_opening_windows_kernel_crash_dump_with_wddebug_gui"></a>
8.2.1.2. Opening Windows kernel crash dump with wddebug_gui</h3>
<p >In driver development, it is not uncommon to experience kernel crashes that lead to the Blue Screen of Death (BSOD). In order to assist developers in debugging and solving these crashes, WinDriver allows saving its kernel debug messages in the memory dump that Windows automatically creates when the system crashes. These crash dumps can later be opened in <code>wddebug_gui</code> after the system was restarted.</p>
<p >To direct the debug messages to a kernel debugger, follow these steps:</p>
<ul>
<li>Open your selected kernel debugger.</li>
<li>Run the Debug Monitor and select to direct the WinDriver debug messages to a kernel debugger, using either of the following methods:<ul>
<li>Open the GUI version of the Debug Monitor — <code>wddebug_gui</code> (available on Windows, Linux, and MacOS), check the “Send debug messages to the operating system kernel debugger” option in the Debug Options window, and press ‘OK’.</li>
<li>Run the console-mode version of the Debug Monitor — <code>wddebug</code> (available on all the supported operating systems) — with the <code>dbg_on</code> command:</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line">WDDEBUG [&lt;driver_name&gt;] dbg_on [&lt;level&gt;] \</div>
<div class="line">   [&lt;sections&gt;]</div>
</div><!-- fragment --><ul>
<li>Load up the WinDriver symbols by going to <b>File</b> | <b>Symbol File Path...</b> and loading your driver's symbols MyDriver.pdb (the file name for the default driver is lib / <code>windrvr1511.pdb</code>). Do not skip this step, otherwise the kernel dump might not be comprehensible.</li>
<li>Load the kernel crash dump (.dmp) file by going to <b>File</b> | <b>Process Kernel Dump...</b> <code>wddebug_gui</code> will display the output from the crash dump.</li>
</ul>
<p >Windows users can use Microsoft’s WinDbg tool, for example, this tool is distributed with the Windows Driver Kit (WDK) and is part of the Debugging Tools for Windows package, distributed via the Microsoft web site.</p>
<h3><a class="anchor" id="ch8_2_1_3_running_wddebug_gui_for_a_renamed_driver"></a>
8.2.1.3. Running wddebug_gui for a Renamed Driver</h3>
<p >By default, wddebug_gui logs messages from the default WinDriver kernel module — <code>windrvr1511.sys/.dll/.o/.ko</code>. However, you can also use wddebug_gui to log debug messages from a renamed version of this driver see <a class="el" href="ch17_driver_installation_advanced_issues.html">Chapter 17: Driver Installation — Advanced Issues</a>, in two ways:</p>
<ul>
<li>From within <code>wddebug_gui</code>, by going to <b>View</b> | **Debug Options and changing the value of the "Driver name" field to your own renamed driver's name.</li>
<li>By running <code>wddebug_gui</code> from the command line with the driver_name argument:</li>
</ul>
<div class="fragment"><div class="line">`wddebug_gui &lt;driver_name&gt;`</div>
</div><!-- fragment --><p >The driver name should be set to the name of the driver file without the file's extension, e.g., <code>windrvr1511</code>, not <code>windrvr1511.sys</code> (on Windows) or <code>windrvr1511.o</code> (on Linux). For example, if you have renamed the default <code>windrvr1511.sys</code> driver on Windows to <code>my_driver.sys</code>, you can log messages from your driver by running the Debug Monitor using the following command:</p>
<div class="fragment"><div class="line">`wddebug_gui my_driver`</div>
</div><!-- fragment --><h2><a class="anchor" id="ch8_2_2_the_wddebug_utility"></a>
8.2.2. The wddebug Utility</h2>
<h3><a class="anchor" id="ch8_2_2_1_console-mode_wddebug_execution"></a>
8.2.2.1. Console-Mode wddebug Execution</h3>
<p >The <code>wddebug</code> version of the Debug Monitor utility can be executed as a console-mode application on all supported operating systems: Windows, and Linux. To use the console-mode Debug Monitor version, run <code>WinDriver/util/wddebug</code> in the manner explained below.</p>
<p ><b>wddebug console-mode usage</b></p>
<div class="fragment"><div class="line">wddebug [&lt;driver_name&gt;] [&lt;command&gt;] [&lt;level&gt;] [&lt;sections&gt;]</div>
</div><!-- fragment --><p >The <code>wddebug</code> arguments must be provided in the order in which they appear in the usage statement above.</p>
<ul>
<li><code>&lt;driver_name&gt;</code> — The name of the driver to which to apply the command.</li>
</ul>
<p >The driver name should be set to the name of the WinDriver kernel module — <code>windrvr1511</code> (default), or a renamed version of this driver (refer to the explanation in <a class="el" href="ch17_driver_installation_advanced_issues.html#ch17_2_renaming_the_windriver_kernel_driver">17.2. Renaming the WinDriver Kernel Driver</a>). We remind that the driver name should be set to the name of the driver file without the file's extension, e.g., <code>windrvr1511</code>, not <code>windrvr1511.sys</code> (on Windows) or <code>windrvr1511.o</code> (on Linux).</p>
<ul>
<li><code>&lt;command&gt;</code>— The Debug Monitor command to execute.</li>
</ul>
<p >Activation commands: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Command   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>on</code>   </td><td class="markdownTableBodyLeft">Turn the Debug Monitor on.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>off</code>   </td><td class="markdownTableBodyLeft">Turn the Debug Monitor off.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>dbg_on</code>   </td><td class="markdownTableBodyLeft">Redirect the debug messages from the Debug Monitor to a kernel debugger and turn the Debug Monitor on (if it was not already turned on). <br  />
 On Windows, the first time that you enable this option you may need to restart the PC. The <code>on</code> and <code>dbg_on</code> commands can be used together with the <code>&lt;level&gt;</code> and <code>&lt;sections&gt;</code> arguments.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>dbg_off</code>   </td><td class="markdownTableBodyLeft">Stop redirecting debug messages from the Debug Monitor to a kernel debugger.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>dump</code>   </td><td class="markdownTableBodyLeft">Continuously send ("dump") debug information to the command prompt, until the user selects to stop (by following the instructions displayed in the command prompt).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>status</code>   </td><td class="markdownTableBodyLeft">Display information regarding the running driver (<code>&lt;driver_name&gt;</code>), the current Debug Monitor status — including the active debug level and sections (when the Debug Monitor is on) — and the size of the debug-messages buffer.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>clock_on</code>   </td><td class="markdownTableBodyLeft">Add a timestamp to each debug message. The timestamps are relative to the driver-load time, or to the time of the last clock_reset command.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>clock_off</code>   </td><td class="markdownTableBodyLeft">Do not add timestamps to the debug messages.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>clock_reset</code>   </td><td class="markdownTableBodyLeft">Reset the debug-messages timestamps clock.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>sect_info_on</code>   </td><td class="markdownTableBodyLeft">Add section(s) information to each debug message.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>sect_info_off</code>   </td><td class="markdownTableBodyLeft">Do not add section(s) information to the debug messages.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>help</code>   </td><td class="markdownTableBodyLeft">Display usage instructions.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">No arguments (including no commands)   </td><td class="markdownTableBodyLeft">This is equivalent to running 'wddebug help'.   </td></tr>
</table>
<p >The following arguments are applicable only with the <code>on</code> or <code>dbg_on</code> commands: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Argument &#160;&#160;&#160;&#160;&#160;&#160;   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>&lt;level&gt;</code>   </td><td class="markdownTableBodyLeft">The debug trace level to set — one of the following flags: <code>ERROR</code>, <code>WARN</code>, <code>INFO</code>, or <code>TRACE</code> (default). <code>ERROR</code> is the lowest trace level and <code>TRACE</code> is the highest level (displays all messages). <br  />
 When the <code>&lt;sections&gt;</code> argument is set, the <code>&lt;level&gt;</code> argument must be set as well (no default).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>&lt;sections&gt;</code>   </td><td class="markdownTableBodyLeft">The debug sections — i.e., the WinDriver API sections — to monitor.   </td></tr>
</table>
<p >This argument can be set either to ALL (default) — to monitor all the supported debug sections — or to a quoted string that contains a combination of any of the supported debug-section flags (run 'wddebug help' to see the full list).</p>
<p ><b>Usage Sequence</b></p>
<p >To log messages using wddebug, use the following sequence:</p>
<ul>
<li>Turn on the Debug Monitor by running wddebug with either the on or dbg_on command; the latter redirects the debug messages to the OS kernel debugger before turning on the Debug Monitor.</li>
</ul>
<p >You can use the <code>&lt;level&gt;</code> and <code>&lt;sections&gt;</code> arguments to set the debug level and sections for the log. If these arguments are not explicitly set, the default values will be used; (note that if you set the sections you must also set the level). You can also log messages from a renamed WinDriver driver by preceding the command with the name of the driver (default: <code>windrvr1511</code>) — see the <code>&lt;driver_name&gt;</code> argument.</p>
<ul>
<li>If you did not select to redirect the debug messages to the OS kernel debugger (using the <code>dbg_on</code> command), run wddebug with the dump command to begin dumping debug messages to the command prompt.</li>
</ul>
<p >You can turn off the display of the debug messages, at any time, by following the instructions displayed in the command prompt.</p>
<ul>
<li>Run applications that use the driver, and view the debug messages as they are being logged to the command prompt/the kernel debugger.</li>
<li>At any time while the Debug Monitor is running, you can run wddebug with the following commands:<ul>
<li><code>status</code>, <code>clock_on</code>, <code>clock_off</code>, <code>clock_reset</code>, <code>sect_info_on</code>, or <code>sect_info_off</code>.</li>
<li><code>on</code> or <code>dbg_on</code> with different <code>&lt;level&gt;</code> and/or <code>&lt;sections&gt;</code> arguments.</li>
<li><code>dbg_on</code> and <code>dbg_off</code> — to toggle the redirection of debug messages to the OS kernel debugger.</li>
<li><code>dump</code> — to start a new dump of the debug log to the command prompt; (the dump can be stopped at any time by following the instructions in the prompt)</li>
</ul>
</li>
<li>When you are ready, turn off the Debug Monitor by running wddebug with the <code>off</code> command.</li>
</ul>
<p >The status command can be used to view information regarding the running WinDriver driver even when the Debug Monitor is off.</p>
<p ><b>Example</b></p>
<p >The following is an example of a typical wddebug usage sequence. Since no <code>&lt;driver_name&gt;</code> is set, the commands are applied to the default driver — <code>windrvr1511</code>.</p>
<p >Turn the Debug Monitor on with the highest trace level for all sections:</p>
<div class="fragment"><div class="line">wddebug on TRACE ALL</div>
</div><!-- fragment --><p >This is the same as running <code>wddebug on TRACE</code>, because <code>ALL</code> is the default <code>&lt;sections&gt;</code> value. Then dump the debug messages continuously to the command prompt or a file, until the user selects to stop:</p>
<div class="fragment"><div class="line">wddebug dump</div>
<div class="line">wddebug dump &lt;filename&gt;</div>
</div><!-- fragment --><p >Following that use the driver and view the debug messages in the command prompt. Turn the Debug Monitor off:</p>
<div class="fragment"><div class="line">wddebug off</div>
</div><!-- fragment --><h3><a class="anchor" id="ch8_2_2_2_debugging_on_a_test_machine"></a>
8.2.2.2. Debugging on a test machine</h3>
<p >In order to debug your WinDriver application and driver a machine that does not have WinDriver installed on it:</p>
<ul>
<li>Copy <code>WinDriver\util\wddebug.exe</code> to your testing machine.</li>
<li>Run <code>wddebug dump</code> from your target machine's command line.</li>
<li>Run your application on a different window.</li>
<li>Stop <code>wddebug</code> utility using CTRL+C.</li>
</ul>
<h1><a class="anchor" id="ch8_3_faq_debugging_drivers"></a>
8.3. FAQ</h1>
<h2><a class="anchor" id="ch8_3_1_should_i_use_wddebug_gui_or_wddebug"></a>
8.3.1. Should I use wddebug_gui or wddebug?</h2>
<p >So why use <code>wddebug_gui</code>?</p>
<p >The GUI version offers easier search options and is more comfortable to use on modern desktop operating systems.</p>
<p >And why use <code>wddebug</code>?</p><ul>
<li>The GUI version depends on Qt, and runs slower than the console-version, and in some cases might make your application run slower when they run at the same time.</li>
<li>If you wish to debug a WinDriver-based user application on a machine that does not have WinDriver installed on it (a redistribution machine)- it would be more complicated to run wddebug_gui on it because you will have to install or copy all Qt DLL/.so dependencies to that machine for the Debug Monitor to work. In contrast, wddebug only requires the wdapi shared library (<code>wdapi1511.dll/.so</code>).</li>
<li>wddebug's source code is available at <code>WinDriver/samples/c/wddebug</code>. This allows you greater flexibility in modifying this application for your specific debugging needs. Jungo does not provide the source code for <code>wddebug_gui</code>.</li>
<li><code>wddebug</code> is easier to use in scripts, or remote console sessions such as PowerShell, SSH, etc.</li>
</ul>
<h2><a class="anchor" id="ch8_3_2_can_i_debug_windriver-based_code_easily_using_ms_visual_studio_visual_cpp"></a>
8.3.2. Can I debug WinDriver-based code easily using MS Visual Studio (Visual C++)?</h2>
<p >Yes! The code of the device driver you write runs in normal Win32 user mode. Therefore, you can compile and debug your code using MS Visual Studio. Generally, WinDriver-based user-code can be debugged on any IDE that allows compiling C/C++ applications in Windows.</p>
<h2><a class="anchor" id="ch8_3_3_how_would_you_recommend_debugging_a_windriver-based_application"></a>
8.3.3. How would you recommend debugging a WinDriver-based application?</h2>
<p >Besides using <code>wddebug_gui</code> / <code>wddebug</code> as described in this chapter, we also recommend using the following tools when needed:</p><ul>
<li>Basic user-mode development: Use IDEs such as Visual Studio / Visual Studio Code / XCode (MacOS) and the debuggers that they offer. Other recommended tools are <code>valgrind</code> (Linux) / <code>Dr. Memory</code> (Windows) for locating memory leaks.</li>
<li>Debugging into calls to the WDAPI shared library: You can use its source code which is available in <code>WinDriver/src/wdapi</code>.</li>
<li>Kernel debugging (For Kernel-PlugIn or identifying issues with WinDriver): In Windows you can use <code>WinDbg</code> / <code>WinDbg Preview</code>. More info on how to set these up is available on MSDN. In Linux/MacOS you can use <code>dmesg</code> to view kernel panics. MacOS also provides crash dumps for every application or kernel crash in a designated directory (Usually <code>~/Library/Logs</code>). </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
